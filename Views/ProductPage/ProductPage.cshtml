@model LapTrinhWebBanHang.Models.Product
@{
    ViewBag.Title = "ProductPage";
    Layout = "~/Views/Shared/_MasterLayout.cshtml";
}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css" />
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>
<link rel="stylesheet" href="~/Content/Product_Page/container_productPage.css" />

<div class="container product-page">
    <div class="content row">
        <div class="content-left col-md-5">
            <div class="list-img">
            </div>
            <div class="img-main">
                <img src="~/Image/product-image/@Model.ImageURL" />
            </div>
        </div>
        <div class="content-mid col-md-4">
            <div class="product-content">
                <div class="product-des">
                    <h3>@Html.DisplayFor(model => model.ProductName)</h3>
                    <p class="description">@Html.DisplayFor(model => model.Description)</p>
                    <p class="price">@Html.DisplayFor(model => model.Price)₫</p>
                </div>
                <div class="select-size">
                    <h6>CHỌN SIZE: </h6>
                    <ul id="sizesList"></ul> <!-- Nơi các nút bấm sẽ được hiển thị -->
                    <div class="instruct-size">
                        <a>HƯỚNG DẪN CHỌN SIZE</a>
                    </div>
                    <div id="selectedSize"></div> <!-- Hiển thị size đã chọn -->
                </div>
                <div class="button-container">
                    <button class="btn yellow-btn">
                        <span>MUA TẠI ĐÂY</span><br>FREE SHIP
                    </button>
                    <a id="addToCartLink" style="color: black; text-decoration: none;" href="/Carts/AddToCart?productId=@Model.ProductID&quantity=1" class="btn btn-primary">Thêm vào giỏ</a>
                </div>
            </div>
        </div>
        <div class="content-right col-md-3">
            <img src="~/image/product_page/AnhQuangCao.png" />
        </div>
    </div>
    <div class="container-tabs">
        <div class="tabs row">
            <div class="tab-item active">
                CHI TIẾT SẢN PHẨM
            </div>
            <div class="tab-item">
                HƯỚNG DẪN CHỌN SIZE
            </div>
            <div class="tab-item">
                HƯỚNG DẪN MUA HÀNG
            </div>
            <div class="tab-item">
                CHÍNH SÁCH BẢO HÀNH
            </div>
            <div class="line"></div>
        </div>
        <!-- Các tab content ở đây (không thay đổi) -->
    </div>

    <!-- Related Products -->
    <h3 class="heading">Sản phẩm liên quan</h3>
    <div class="related-products row responsive" data-slick='{"slidesToShow": 4, "slidesToScroll": 4}'>
        @for (int i = 0; i < 8; i++)
        {
            <div onclick="window.location.href='@Url.Action("ProductPage", "ProductPage")'" class="product-item col-lg-3 sol-sm-4 col-6">
                <div class="product-image">
                    <img src="~/Image/product-image/hot_product/ZM SUPERFLY 10 ELITE FG.png" alt="" />
                </div>
                <div class="product-content">
                    <h6>Nike Mercurial Superfly 10 Elite Blueprint FG</h6>
                    <p class="description-product">Pink Foam/Black</p>
                    <div class="price-container">
                        <p class="price">2,150,000₫</p>
                    </div>
                </div>
            </div>
        }
    </div>
    <script>
    document.addEventListener('DOMContentLoaded', function () {
        const productId = @Model.ProductID;
        let selectedSize = null;  // Biến lưu trữ size đã chọn

        // Lấy danh sách kích thước
        fetch(`/ProductPage/GetProductSizesWithoutQuantity?productId=${productId}`, {
            method: 'GET',
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                document.getElementById('sizesList').innerHTML = '';

                // Render danh sách kích thước sản phẩm dưới dạng các checkbox
                if (data.sizes && data.sizes.length > 0) {
                    data.sizes.forEach(function (size) {
                        const label = document.createElement('label');
                        label.classList.add('style-everyList');

                        const checkbox = document.createElement('input');
                        checkbox.type = 'checkbox';
                        checkbox.name = 'selectedSize';
                        checkbox.value = size;

                        const span = document.createElement('span');
                        span.textContent = size;

                        label.appendChild(checkbox);
                        label.appendChild(span);

                        checkbox.addEventListener('change', function () {
                            if (checkbox.checked) {
                                selectedSize = size;  // Lưu giá trị kích thước khi chọn
                                document.getElementById('selectedSize').textContent = `Size đã chọn: ${size}`;

                                // Cập nhật liên kết "Thêm vào giỏ" với kích thước đã chọn
                                document.getElementById('addToCartLink').href = `/Carts/AddToCart?productId=${productId}&quantity=1&size=${selectedSize}`;
                            } else {
                                selectedSize = null;  // Nếu bỏ chọn, gỡ bỏ kích thước đã chọn
                                document.getElementById('selectedSize').textContent = 'Size đã chọn:';

                                // Cập nhật lại liên kết "Thêm vào giỏ"
                                document.getElementById('addToCartLink').href = `/Carts/AddToCart?productId=${productId}&quantity=1`;
                            }
                        });

                        document.getElementById('sizesList').appendChild(label);
                    });
                } else {
                    const message = document.createElement('span');
                    message.textContent = 'Không có kích thước nào';
                    document.getElementById('sizesList').appendChild(message);
                }
            } else {
                document.getElementById('sizesList').innerHTML = '';
                alert(data.message || "Không tìm thấy sản phẩm.");
            }
        })
        .catch(error => {
            console.log("Error:", error); // Kiểm tra lỗi nếu có
            alert("Đã xảy ra lỗi khi lấy danh sách kích thước sản phẩm.");
        });
    });
        $('.responsive').slick({
            dots: true,
            infinite: false,
            speed: 600,
            slidesToShow: 4,
            slidesToScroll: 4,
            responsive: [
                {
                    breakpoint: 1024,
                    settings: {
                        slidesToShow: 3,
                        slidesToScroll: 3,
                        infinite: true,
                        dots: true
                    }
                },
                {
                    breakpoint: 600,
                    settings: {
                        slidesToShow: 2,
                        slidesToScroll: 2
                    }
                },
                {
                    breakpoint: 480,
                    settings: {
                        slidesToShow: 1,
                        slidesToScroll: 1
                    }
                }
            ],
            prevArrow: "<button type='button' class='slick-prev pull-left'><i class='fa-solid fa-arrow-left' aria-hidden='true'></i></button>",
            nextArrow: "<button type='button' class='slick-next pull-right'><i class='fa-solid fa-arrow-right' aria-hidden='true'></i></button>"
        });
    </script>
    <h3 class="heading">Brand</h3>
    <div class="brands row">
        <div class="col-md-3"><img src="~/Image/thumbnail/NikePack/NikeWhitePack(1).jpg" /></div>
        <div class="col-md-3"><img src="~/Image/thumbnail/AdidasPack/AdidasWhitePack.jpg" /></div>
        <div class="col-md-3"><img src="~/Image/thumbnail/PumaPack/PumaLightsOutPack.jpg" /></div>
        <div class="col-md-3"><img src="~/Image/thumbnail/NikePack/NikeWhitePack(1).jpg" /></div>
    </div>
</div>
